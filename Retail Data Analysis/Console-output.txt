-------------------------------------------
Batch: 0
-------------------------------------------
+----------+-------+---------+----------+-----------+--------+---------+
|invoice_no|country|timestamp|total_cost|total_items|is_order|is_return|
+----------+-------+---------+----------+-----------+--------+---------+
+----------+-------+---------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 1
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132554241002|United Kingdom|2023-04-22 14:06:14|2.1       |1          |1       |0        |
|154132554241003|United Kingdom|2023-04-22 14:06:22|50.77     |13         |1       |0        |
|154132554241004|United Kingdom|2023-04-22 14:06:25|99.479996 |12         |1       |0        |
|154132554241005|United Kingdom|2023-04-22 14:06:28|25.92     |3          |1       |0        |
|154132554241006|United Kingdom|2023-04-22 14:06:42|102.12    |106        |1       |0        |
|154132554241007|United Kingdom|2023-04-22 14:06:45|7.1099997 |5          |1       |0        |
|154132554241008|EIRE          |2023-04-22 14:06:47|6.62      |6          |1       |0        |
|154132554241009|United Kingdom|2023-04-22 14:06:54|37.199997 |8          |1       |0        |
|154132554241010|United Kingdom|2023-04-22 14:06:57|24.96     |20         |1       |0        |
|154132554241011|France        |2023-04-22 14:07:01|0.78      |2          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 2
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132554241012|United Kingdom|2023-04-22 14:07:29|30.75     |20         |1       |0        |
|154132554241013|United Kingdom|2023-04-22 14:07:39|213.08    |1          |1       |0        |
|154132554241014|United Kingdom|2023-04-22 14:07:55|4.95      |1          |1       |0        |
|154132554241015|United Kingdom|2023-04-22 14:07:59|21.25     |7          |1       |0        |
|154132554241016|United Kingdom|2023-04-22 14:08:02|77.34     |22         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 3
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132554241017|United Kingdom|2023-04-22 14:08:16|16.21     |17         |1       |0        |
|154132554241018|United Kingdom|2023-04-22 14:08:17|50.59     |59         |1       |0        |
|154132554241019|United Kingdom|2023-04-22 14:08:20|3.32      |2          |1       |0        |
|154132554241020|United Kingdom|2023-04-22 14:08:24|-72.0     |18         |0       |1        |
|154132554241021|United Kingdom|2023-04-22 14:08:26|-24.63    |10         |0       |1        |
|154132554241022|United Kingdom|2023-04-22 14:08:29|86.35     |21         |1       |0        |
|154132554241023|United Kingdom|2023-04-22 14:08:36|30.48     |14         |1       |0        |
|154132554241024|United Kingdom|2023-04-22 14:08:38|2.1       |1          |1       |0        |
|154132554241025|United Kingdom|2023-04-22 14:08:40|79.89     |19         |1       |0        |
|154132554241026|United Kingdom|2023-04-22 14:08:52|21.150002 |15         |1       |0        |
|154132554241027|United Kingdom|2023-04-22 14:08:54|35.73     |32         |1       |0        |
|154132554241028|United Kingdom|2023-04-22 14:09:00|29.73     |17         |1       |0        |
|154132554241029|United Kingdom|2023-04-22 14:09:04|13.7699995|6          |1       |0        |
|154132554241030|United Kingdom|2023-04-22 14:09:06|47.94     |49         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 4
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132554241031|United Kingdom|2023-04-22 14:09:13|114.84    |100        |1       |0        |
|154132554241032|United Kingdom|2023-04-22 14:09:16|185.91    |82         |1       |0        |
|154132554241033|United Kingdom|2023-04-22 14:09:18|17.55     |13         |1       |0        |
|154132554241034|United Kingdom|2023-04-22 14:10:00|-32.15    |21         |0       |1        |
|154132554241035|United Kingdom|2023-04-22 14:10:00|20.06     |13         |1       |0        |
|154132554241036|United Kingdom|2023-04-22 14:10:02|4.7400002 |6          |1       |0        |
|154132554241037|United Kingdom|2023-04-22 14:10:05|56.1      |26         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 5
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132554241038|United Kingdom|2023-04-22 14:10:25|2.08      |1          |1       |0        |
|154132554241039|United Kingdom|2023-04-22 14:10:26|122.159996|64         |1       |0        |
|154132554241040|United Kingdom|2023-04-22 14:10:30|279.05    |57         |1       |0        |
|154132554241041|United Kingdom|2023-04-22 14:10:38|24.09     |25         |1       |0        |
|154132554241042|United Kingdom|2023-04-22 14:10:40|7.6       |14         |1       |0        |
|154132554241043|Netherlands   |2023-04-22 14:10:57|801.63    |97         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 6
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132554241044|United Kingdom|2023-04-22 14:11:05|129.36    |24         |1       |0        |
|154132554241045|United Kingdom|2023-04-22 14:11:06|24.8      |10         |1       |0        |
|154132554241046|United Kingdom|2023-04-22 14:11:12|19.8      |12         |1       |0        |
|154132554241047|United Kingdom|2023-04-22 14:11:28|-42.0     |19         |0       |1        |
|154132554241048|United Kingdom|2023-04-22 14:11:29|117.2     |29         |1       |0        |
|154132554241049|United Kingdom|2023-04-22 14:11:31|7.35      |5          |1       |0        |
|154132554241050|United Kingdom|2023-04-22 14:11:39|20.039999 |25         |1       |0        |
|154132554241051|Belgium       |2023-04-22 14:11:41|69.54     |41         |1       |0        |
|154132554241052|United Kingdom|2023-04-22 14:12:03|2.1       |2          |1       |0        |
|154132554241053|United Kingdom|2023-04-22 14:12:04|26.22     |9          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 7
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132554241054|United Kingdom|2023-04-22 14:12:04|95.83     |23         |1       |0        |
|154132554241055|United Kingdom|2023-04-22 14:12:04|62.9      |14         |1       |0        |
|154132554241056|United Kingdom|2023-04-22 14:12:07|65.62     |26         |1       |0        |
|154132554241057|United Kingdom|2023-04-22 14:12:08|14.009999 |26         |1       |0        |
|154132554241058|United Kingdom|2023-04-22 14:12:08|44.11     |10         |1       |0        |
|154132554241059|Netherlands   |2023-04-22 14:12:09|34.16     |9          |1       |0        |
|154132554241060|United Kingdom|2023-04-22 14:12:14|105.4     |24         |1       |0        |
|154132554241061|United Kingdom|2023-04-22 14:12:22|106.42    |27         |1       |0        |
|154132554241062|United Kingdom|2023-04-22 14:12:51|68.01     |43         |1       |0        |
|154132554241063|United Kingdom|2023-04-22 14:13:00|72.77     |19         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 8
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132554241064|United Kingdom|2023-04-22 14:13:04|215.2     |64         |1       |0        |
|154132554241065|United Kingdom|2023-04-22 14:13:06|76.25     |35         |1       |0        |
|154132554241066|United Kingdom|2023-04-22 14:13:12|19.19     |7          |1       |0        |
|154132554241067|United Kingdom|2023-04-22 14:13:26|135.0     |36         |1       |0        |
|154132554241068|United Kingdom|2023-04-22 14:13:28|25.47     |9          |1       |0        |
|154132554241069|Belgium       |2023-04-22 14:13:29|17.45     |13         |1       |0        |
|154132554241070|United Kingdom|2023-04-22 14:13:30|37.42     |35         |1       |0        |
|154132554241071|United Kingdom|2023-04-22 14:13:36|35.52     |10         |1       |0        |
|154132554241072|United Kingdom|2023-04-22 14:13:37|21.74     |6          |1       |0        |
|154132554241073|United Kingdom|2023-04-22 14:13:39|4.92      |2          |1       |0        |
|154132554241074|Belgium       |2023-04-22 14:13:46|2.95      |1          |1       |0        |
|154132554241075|United Kingdom|2023-04-22 14:13:46|2.46      |1          |1       |0        |
|154132554241076|United Kingdom|2023-04-22 14:13:52|39.43     |26         |1       |0        |
|154132554241077|United Kingdom|2023-04-22 14:13:56|36.28     |38         |1       |0        |
|154132554241078|United Kingdom|2023-04-22 14:13:56|93.22     |21         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 9
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132554241079|United Kingdom|2023-04-22 14:14:04|108.96    |46         |1       |0        |
|154132554241080|United Kingdom|2023-04-22 14:14:18|117.0     |26         |1       |0        |
|154132554241081|United Kingdom|2023-04-22 14:14:24|93.92     |66         |1       |0        |
|154132554241082|United Kingdom|2023-04-22 14:14:26|45.6      |18         |1       |0        |
|154132554241083|United Kingdom|2023-04-22 14:14:49|16.2      |6          |1       |0        |
|154132554241084|United Kingdom|2023-04-22 14:14:53|87.45     |53         |1       |0        |
|154132554241085|United Kingdom|2023-04-22 14:14:53|3.75      |1          |1       |0        |
|154132554241086|United Kingdom|2023-04-22 14:15:01|5.79      |1          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 10
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132554241087|United Kingdom|2023-04-22 14:15:18|10.0      |8          |1       |0        |
|154132554241088|United Kingdom|2023-04-22 14:15:20|394.16998 |108        |1       |0        |
|154132554241089|United Kingdom|2023-04-22 14:15:28|5.4       |2          |1       |0        |
|154132554241090|United Kingdom|2023-04-22 14:15:40|39.86     |8          |1       |0        |
|154132554241091|United Kingdom|2023-04-22 14:15:40|2.46      |1          |1       |0        |
|154132554241092|United Kingdom|2023-04-22 14:15:46|27.32     |14         |1       |0        |
|154132554241093|United Kingdom|2023-04-22 14:15:59|36.24     |16         |1       |0        |
|154132554241094|United Kingdom|2023-04-22 14:15:59|5.1000004 |6          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

Traceback (most recent call last):
  File "/home/hadoop/spark-streaming.py", line 137, in <module>
    console_extended_data_stream.awaitTermination()
  File "/usr/lib/spark/python/lib/pyspark.zip/pyspark/sql/streaming.py", line 103, in awaitTermination
  File "/usr/lib/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1255, in __call__
  File "/usr/lib/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 985, in send_command
  File "/usr/lib/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1152, in send_command
  File "/usr/lib64/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/usr/lib/spark/python/lib/pyspark.zip/pyspark/context.py", line 278, in signal_handler
KeyboardInterrupt
